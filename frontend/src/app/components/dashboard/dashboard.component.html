<div class="dashboard-container">
  <!-- Header -->
  <mat-toolbar color="primary">
    <span>Sales Analytics Dashboard</span>
    <span class="spacer"></span>
    
    <!-- Navigation to Sales Management -->
    <button mat-button routerLink="/sales">
      <mat-icon>manage_accounts</mat-icon>
      Manage Sales Data
    </button>

    <!-- Theme Toggle -->
    <button mat-icon-button class="theme-toggle" [matTooltip]="currentTheme() === 'light' ? 'Switch to dark mode' : 'Switch to light mode'" (click)="toggleTheme()">
      <mat-icon>{{ currentTheme() === 'light' ? 'dark_mode' : 'light_mode' }}</mat-icon>
    </button>

    <button mat-icon-button>
      <mat-icon>notifications</mat-icon>
    </button>
    <button mat-button>
      <mat-icon>account_circle</mat-icon>
      Admin User
    </button>
  </mat-toolbar>

  <!-- Main Content -->
  <div class="dashboard-content">
    
    <!-- KPI Cards Row -->
    <div class="kpi-row">
      <mat-card class="kpi-card">
        <mat-card-header>
          <mat-card-title>Total Revenue</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <h2>$124,560</h2>
          <span class="positive">↑ 12% from last month</span>
        </mat-card-content>
      </mat-card>

      <mat-card class="kpi-card">
        <mat-card-header>
          <mat-card-title>New Customers</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <h2>324</h2>
          <span class="positive">↑ 8% from last month</span>
        </mat-card-content>
      </mat-card>

      <mat-card class="kpi-card">
        <mat-card-header>
          <mat-card-title>Conversion Rate</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <h2>3.2%</h2>
          <span class="negative">↓ 0.5% from last month</span>
        </mat-card-content>
      </mat-card>

      <mat-card class="kpi-card">
        <mat-card-header>
          <mat-card-title>Avg. Order Value</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <h2>$156</h2>
          <span class="positive">↑ $12 from last month</span>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Charts Row -->
    <div class="charts-row">
      <mat-card class="chart-card">
        <mat-card-header>
          <mat-card-title>Revenue Trend</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div style="height: 300px">
            <canvas baseChart
              [type]="'line'"
              [data]="revenueChartData()"
              [options]="chartOptions"
              (chartClick)="onChartClick($event, 'revenue')">
            </canvas>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="chart-card">
        <mat-card-header>
          <mat-card-title>Sales by Region</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div style="height: 300px">
            <canvas baseChart
              [type]="'bar'"
              [data]="regionChartData"
              [options]="chartOptions"
              (chartClick)="onChartClick($event, 'region')">
            </canvas>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <mat-card class="filter-card">
      <mat-card-header>
        <mat-card-title>Filter Transactions</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Search by Customer, Order ID, or Status</mat-label>
          <input matInput type="text" #searchInput (input)="searchText.set(searchInput.value)">
          <mat-icon matSuffix>search</mat-icon>
        </mat-form-field>
      </mat-card-content>
      
      <button mat-raised-button color="primary" (click)="exportToCsv()">
        <mat-icon>file_download</mat-icon>
        Export to CSV
      </button>
    </mat-card>

    <!-- Data Table -->
    <mat-card class="table-card">
      <mat-card-header>
        <mat-card-title>Recent Transactions</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <table mat-table [dataSource]="filteredTransactions()" class="mat-elevation-z8">
          
          <!-- ID Column -->
          <ng-container matColumnDef="id">
            <th mat-header-cell *matHeaderCellDef>Order ID</th>
            <td mat-cell *matCellDef="let transaction">{{transaction.id}}</td>
          </ng-container>

          <!-- Customer Column -->
          <ng-container matColumnDef="customer">
            <th mat-header-cell *matHeaderCellDef>Customer</th>
            <td mat-cell *matCellDef="let transaction">{{transaction.customer}}</td>
          </ng-container>

          <!-- Amount Column -->
          <ng-container matColumnDef="amount">
            <th mat-header-cell *matHeaderCellDef>Amount</th>
            <td mat-cell *matCellDef="let transaction">${{transaction.amount}}</td>
          </ng-container>

          <!-- Status Column -->
          <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef>Status</th>
            <td mat-cell *matCellDef="let transaction">
              <span [class]="'status-' + transaction.status">
                {{transaction.status}}
              </span>
            </td>
          </ng-container>

          <!-- Date Column -->
          <ng-container matColumnDef="date">
            <th mat-header-cell *matHeaderCellDef>Date</th>
            <td mat-cell *matCellDef="let transaction">{{transaction.date}}</td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
      </mat-card-content>
    </mat-card>
  </div>
</div>